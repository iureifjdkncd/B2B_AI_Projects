## Project B – 확률적 예측 기반 제당 공정 품질 추론 및 공정조건 최적화 시스템
(S사 제당공정 기업 / AI 바우처 사업 / 2024.05 ~ 2025.03)

--- 

### 프로젝트 개요
- 제당 공정의 다변량 품질 변수를 대상으로 **ML/DL 기반 확률적 예측 시스템** 구축.
- **목표 품질값 정의에 따라 공정조건을 추천하는 알고리즘**을 설계하고, 이를 실시간 시스템에 적용 가능하도록 구현.
- 품질 향상과 생산 조건 최적화를 동시에 달성하여 **실시간 가이던스 제공**을 목표로 함.

--- 

### 문제 정의
- 1.) **다음 시점 품질 예측의 필요성**
  - 공정 구간: [원당 → 용해 → 포충 → 여과 → 정제 → 이중효용관 → MVR]
  - 예측 대상: 포충 1·2탑 ML 공급유량, MVR 공정 FL_BRIX 농도.
  - 목표: 10분 후 3개 품질 변수 동시 예측.
- 2.) **목표값 대비 최적 공조건 탐색 요구**
  - 예측 혹은 사용자 정의 목표값 대비 **동등 이상 품질을 보장하는 다변량 조건 추천** 필요.
  - Data Drift 및 품질 측정 불확실성을 반영한 **적응형 예측 및 추천 시스템** 필요.

--- 

### 핵심 알고리즘 및 기술 구성
- 1.) **Tree 기반 Quantile Regression**
  - XGBoost, LightGBM, GBM, HistGBM 활용.
  - 각 품질 변수의 CV(변동계수)를 반영해 Lower/Upper Quantile 학습.
- 2.)	**Monte Carlo Dropout 기반 BiLSTM/GRU**
  - 100회 Simulation을 통한 예측 분포 추정.
  - mean ± k·std 형태로 불확실성 정량화.(K → 각 품질 변수의 CV(변동계수)를 반영)
- 3.)	**KDE 기반 품질 분포 모델링**
  - ML/DL 예측값 집합의 Min/Mean/Max 기반으로 KDE 파라미터 설정.
  - CV 기반으로 상·하한 경계 추정.
- 4.)	**Gamma-KDE 기반 보정**
  - 최근 100개 각 품질 실측값의 표준편차 기반 Gamma 분포 파라미터 추정.
  - 예측 분포에 불확실성 보정값 추가 반영.
- 5.)	**K-Means 기반 공정조건 군집화**
  - 학습데이터(Recipe) 기반으로 군집 분리.
  - 실시간 입력에 대한 동일 군집 혹은 최근접 군집을 활용하여 최적 조건 탐색.

---

### 실시간 추론 프로세스
- 1.)	**실시간 데이터 수집 및 예측**
  - 각 품질 변수를 ML/DL 앙상블로 예측.
  - 예측값 집합으로 KDE 분포 생성 → CV 기반 상·하한선 추정 및 신뢰구간 산출.
- 2.) **목표 대비 예측값 보정**
  - 사용자 정의 or 예측 목표 입력.
  - KDE 분포에서 목표 이상 조건을 1차 선별.
  - Gamma-KDE 보정을 거쳐 목표 이상 조건을 재선택.
- 3.) **최적 공정조건 탐색**
  - Recipe 데이터 기반으로 실시간 입력과 유사한 군집 탐색.
  - 목표(Gamma-KDE 보정값) 이상을 만족하는 과거 조건 중 최적 조건 1개 선택.
  - 예외 처리용 2-Track 필터(df_origin, df_cluster) 적용, 과대/과소 추정 방지.
- 4.) **Recipe Update**
  - 실시간 입력 데이터 누적으로 시스템 지속성 강화

---

### 기술 차별성
- 1.) **정량적 예측 + 조건 최적화 통합**
  - 예측값 확률 분포 정량화와 조건 추천을 **하나의 파이프라인**으로 통합.
- 2.) **지속 가능성 확보**
  - 실시간 입력 데이터를 기존 Recipe 데이터에 자동 업데이트하여 추론의 **지속가능성** 보장.
- 3.) **목표값 기반 경로탐색**
  - Gamma-KDE 기반 불확실성 보정.
  - 목표 대비 조건 후보군 선별 및 정량적 조건 선택 로직 설계.

--- 

#### 주요 성과
- 초기 실험 기준 예측 정확도 약 95%, 현장 적용 기준 **87~91%** 유지.
- 작업자 Rule-Based 대비, AI 기반 조건 추천 일치율 **85~90%** 달성.
- 실제 운전 시 FL_BRIX 품질 약** 1% 향상**.

---

#### 기여도
- **시스템 아키텍처 설계 및 핵심 알고리즘 구현** 주도.
- **ML/DL 앙상블 구조 설계**: Quantile Tree Models + MC Dropout BiLSTM/GRU 통합.
- **KDE & Gamma-KDE 기반 분포 정량화 및 목표 기반 조건 추론 알고리즘** 설계.
- 예측 경로 탐색 실패·불안정 구간 대응을 위한 **예외처리 및 Fallback 정책** 구현.
- 실시간 Recipe 데이터 업데이트 구조 설계 → **운영 지속 가능성 및 실시간 대응력 강화.**


---
