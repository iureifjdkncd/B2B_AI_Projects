## Project B: 확률적 예측 기반 제당 공정 품질 추론 및 조건 최적화 시스템
(S사 제당공정 기업 / AI 바우처 사업 / 수행기간: 2024.05 ~ 2025.03)

--- 

#### 프로젝트 개요
- 제당 공정의 품질 예측을 위한 ML/DL 기반 확률적 예측 시스템 구축
- 목표값 정의 기반 공정조건 추천 알고리즘 설계 및 전과정 시스템 실시간 적용 가능성 확보

--- 

#### 문제 정의

1.) 다음 시점(10분 이후) 3개 품질 변수 예측 필요

- 공정 구간: [원당-용해-포충-여과-정제-이중효용관-MVR]

- 예측 대상 품질 : 포충1,2탑 ML공급유량  + MVR공정 FL_BRIX 농도

2.) 예측 or 사용자 정의 목표값 대비 같거나 큰 품질값을 만족시키는 다변량 공정조건 추천 필요

- 측정 품질 불확실성과 Data Drift를 고려한 적응형 예측 및 추천 시스템 필요

--- 

#### 핵심 알고리즘 및 기술 구성

1.) Tree 기반 Quantile Regression

- XGBoost, LightGBM, GBM, HistGBM 등 사용

- 각 품질변수의 CV(변동계수)를 활용한 Lower/Upper quantile regression 학습

2.) Monte Carlo Dropout 기반 BiLSTM/GRU

- 100회 Simulation 기반 예측 분포 추정

- mean ± k * std 형태로 불확실성 반영

3.) KDE 기반 품질 분포 모델링

- 각 품질당 전체 ML/DL예측값들의 Min/Mean/Max 기반 KDE 파라미터 설정

- CV 기반 상/하한선 추정

4.) Gamma-KDE 기반 보정

- 예측값과 최근 100개 실측값의 표준편차 기반 Gamma 분포 모수 추정

- 예측 불확실성 추가 반영

5.) KMeans 기반 공정조건 군집화

- 원산지 + 원당 기반 Recipe 군집 분리

- 동일 군집 혹은 최근접 군집 기반으로 최적 조건 탐색

---

#### 실시간 추론 프로세스

1.) 실시간 데이터 수집 및 예측
   
- 각 품질변수 예측  → ML/DL Ensemble 예측값으로부터 KDE 기반 분포 생성

- KDE의 CV 기반 상/하한 경계 추정 → 예측 품질의 신뢰구간, 최종 평균 추정치 도출

2.) 목표 대비 예측값 선택 및 보정
- 사용자 정의 or 예측 목표값 입력

- 각 KDE 분포에서 목표 이상 값 1차 선택

- Gamma-KDE 보정 → 2차로 목표 이상 값 재선택

3.) 최적 조건 탐색 및 선택
- 전체 Recipe 데이터로부터 현재 입력 조건과 유사한 군집 탐색

- 목표 이상 품질을 만족시키는 과거 조건들 중 최적 조건 1개 선택

- 예외처리 포함한 2-track 조건 필터링 적용 (df_origin, df_cluster)

- 조건 과대/과소 추정 방지 로직 적용 → 안정적인 조건 추론 보장

---

#### 기술 차별성

1.) 정량적 품질 예측 + 공정정조건 최적화 통합 시스템

- 예측값 기반 확률 분포 정량화 후 공정조건 추천까지 연계된 전과정 통합

2.) 최적조건 추론 지속가능성 확보

- 실시간 입력 데이터를 기존 Recipe데이터에 자동 업데이트 

3.) 목표값 기반 경로탐색 알고리즘 설계

- Gamma-KDE 기반 보정으로 불확실성 반영

- 최근사 예측값 기반 조건 후보군 선택 및 정량적 조건 선택 로직 구현

--- 

#### 주요 성과

1.) 초기 예측 정확도 실험 기준 약 95%, 현장 기준 87~91% 달성
 
2.) 작업자 기반 RuleBased 대비 AI 예측기반 추천조건 운전 시 조건 일치율 85~90% 유지

3.) 실제 시스템 운전 시 설탕품질(FL_BRIX농도) 약 1% 향상

---

#### 기여도

- 전체 시스템 아키텍처 설계 및 핵심 알고리즘 구현 

- DL (MC Dropout 기반 BiLSTM/GRU) + ML (Quantile Tree Models) 앙상블 구조 설계

- 예측 기반 KDE, Gamma-KDE 분포 정량화 및 목표 기반 조건 추론 알고리즘 설계

- 예측 경로 탐색 실패 및 불안정 구간 대응 예외처리 및 fallback 정책 직접 구현

- 실시간 Recipe데이터 업데이트 구조 설계 → 운영 지속 가능성 및 실시간 대응력 강화

---
