## Project A - 비지도 학습 기반 사출 품질 예측 및 최적 세팅 추천 시스템
(A사 자동차 부품 제조기업 / 자율형 공장 구축 사업 / 수행기간: 2023.08 ~ 2025.07)

--- 

#### 프로젝트 개요
- 사출 공정에서 1:1 품질 라벨이 없는 데이터를 기반으로 군집과 비지도 이상 탐지 모델을 활용한 불량 탐지 시스템을 구축 & 설비·품목·세팅 조건별 데이터 분포에 따른 유연한 추론 적용.
  
- 실질적인 불량률 감소와 품질 향상 예측 기반 학습 데이터 라벨링을 통해 최적 생산 조건 가이던스 제공. 
--- 

#### 문제 정의
1.) 1:1 품질 라벨링의 부재

- Postgre Raw 사출 생산 데이터는 1일 Lot 단위로 기록되며, 개별 샘플 단위로 Good/Bad 품질 여부가 라벨링되지 않음.

- 각 샘플은 Lot 단위 총 생산량 기반으로만 Good/Bad 수치를 보유하고 있음 → 개별 입력값에 대한 품질 판단 불가.

2.) Setting 조합에 따른 데이터 분포 차이

- 동일 Maker 및 Facility-Item 조합이라도, 생산 시점에 따라 서로 다른 Setting(공정 조건)으로 운영됨.

- Setting 조합에 따라 입력 데이터의 분포가 상이하므로, 독립적인 학습군 구성 필요.

--- 

#### 주요 전처리 및 비지도 학습 방법

1.) Lot 단위 품질 통계 기반 데이터 정의

- 1일 단위 생산 Lot의 총 생산량을 기준으로 불량률(defect_rate)을 집계.

- 총불량률이 1.0% 미만인 데이터는 학습용으로 사용, 이상은 검증용으로 분리하여 과적합 방지.

2.) Unique Setting 조합 및 클러스터링

- 다변량 Setting 데이터를 기반으로 중복 제거 후, 고유 Setting 조합을 추출.

- K-Means 기반 Clustering을 통해 Cluster 번호 부여 → 학습 모델 단위로 데이터 분할.

3.) 클러스터별 비지도 학습 모델 구성

- 분할된 Facility-Item-Setting Cluster 단위로 샘플 수에 따라 모델 유형 결정:

   - 5000개 이상: Memory-Augmented AutoEncoder

   - 1000개~5000개: AutoEncoder

   - 1000개 미만: IsolationForest

- AE 기반 모델은 Early Stopping 및 Best Weight 로직을 적용하여 학습 안정성 확보.

--- 

#### 실시간 추론 프로세스
1.) MongoDB 기반 실시간 데이터 전처리

- 결측치(품목명, Setting, 생산량 등)는 Forward/Backward/Mean/Mode Fill로 보완.

- 예측 불가 조건은 사전에 예외처리하여 시스템 중단 방지.

2.) 기본 추론 (학습이력 존재)

- 현재 Setting 정보를 기반으로 Cluster를 예측 → 해당 Cluster에 학습된 모델 불러오기.

- MinMaxScaler(clip=True)로 예측값 스케일링 → 발산 방지.

- 학습된 MAE Loss 분포의 변동계수(CV) 기반으로 threshold에 가중치 및 margin limit 부여.

3.) 적응형 추론 (학습이력 없음)

- Euclidean Distance 기반 최근접 Setting 탐색.

- 해당 근접 Cluster의 학습 모델을 사용하여 대체 추론 수행.

- 기존 임계값 대신 CV + 거리 기반 가중 임계값을 적용하여 예측 오차 허용.

--- 

#### 최적 생산 조건 도출 및 품질 가이던스
1.) 모델 기반 품질 임시 라벨링

- 학습된 AE 모델의 임계값 기반으로 기존 데이터에 비지도 품질 라벨 부여.

2.) 설비/품목 기준 최적 Setting 정리

- 과거 생산 이력 중 최다 생산 + 최소 예측 불량률 Setting을 추출.

- 각 Setting 조합별 Min/Mean/Max 생산 데이터 및 품질 통계 정량화.

3.) 생산 계획 참고용 데이터셋 구축

- 라벨링된 과거 데이터를 기반으로 설비/품목별 최적 조건 가이던스 제공.
  
--- 

#### 주요 성과
- 초기 실험 데이터 기준 불량 탐지 정확도 약 86%, 실제 현장 적용 시 약 67%로 수렴.

- AI 시스템 완성 후 적응형 추론 고도화를 통해 불량 탐지 정확도 평균 약 16% 향상.

- 예측 기반 품질 통계를 활용한 생산 최적화 가이드 도입으로, 생산 불량률 약 5% 감소 달성.

--- 

#### 기여도 
- 전체 데이터 전처리, K-Means 기반 Setting 분할 로직 및 클러스터링 설계

- AE / MemAE 기반 비지도 이상 탐지 모델 개발 및 학습 구조 고도화

- 실시간 품질 추론 로직 및 적응형 추론 알고리즘 구현

- Threshold 가중치 설정 및 Margin 기반 추론 유연화 전략 설계

- 모델 기반 과거 데이터 라벨링 및 생산 최적 조건 정량화 모듈 구축

--- 

